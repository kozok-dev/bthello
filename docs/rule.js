const Rule=new function(){var r,a,o;const t=[],i=[];function n(a){if(Board.getDisc(a)!=Board.EMPTY)return!1;var o=r==Board.BLACK?Board.WHITE:Board.BLACK;return!1!==e(a=c(a),o,-9)||(!1!==e(a,o,-8)||(!1!==e(a,o,1)||(!1!==e(a,o,10)||(!1!==e(a,o,9)||(!1!==e(a,o,8)||(!1!==e(a,o,-1)||!1!==e(a,o,-10)))))))}function e(a,o,t){for(var i=!1;;){if((a+=t)<10||a>80||a%9==0)return!1;if(Board.getDisc(f(a))!=o)break;i=!0}return!(!i||Board.getDisc(f(a))!=r)&&a}function s(){for(var r=0;r<64;r++)d(r)}function B(o){var n=a<t.length&&t[a][1]==o?.6:.3;if(0==i.length||-1==i.indexOf(o))Tick.stop("flip-"+o),r==Board.BLACK?Board.setMark(o,15,0,17,17,n):Board.setMark(o,15,255,238,238,n);else{var e=0;Tick.interval("flip-"+o,function(){var a,t;switch(e){case 0:a=15,t=null,e=1;break;case 1:a=25,t=500,e=2;break;default:a=15,t=500,e=1}return r==Board.BLACK?Board.setMark(o,a,0,17,17,n,t):Board.setMark(o,a,255,238,238,n,t),!0},500)}}function d(r){Tick.stop("flip-"+r),Board.setMark(r,0)}function c(r){return r+9+Math.floor(r/8)+1}function f(r){return r-9-Math.floor(r/9)}this.markSquare=i,this.setDisc=function(a){r=a},this.getTurn=function(){return{disc:r,passFlag:o,move:a}},this.init=function(){for(var n=0;n<64;n++)Board.setDisc(n,Board.EMPTY);Board.setDisc(27,Board.WHITE),Board.setDisc(28,Board.BLACK),Board.setDisc(35,Board.BLACK),Board.setDisc(36,Board.WHITE),Board.setMoveMark(null),r=Board.BLACK,a=0,o=!1,t.splice(0,t.length),s(),i.splice(0,i.length)},this.canFlip=n,this.flip=function(i,s){Tick.stopAll("^flip-.+");var B=[];Board.setDisc(i,r,null,s),Board.setMoveMark(i),B.push(r),B.push(i);var d=r==Board.BLACK?Board.WHITE:Board.BLACK;function u(a,o){if(!1!==(a=e(a,d,o)))for(;a-=o,Board.getDisc(f(a))==d;)Board.setDisc(f(a),r,30,s),B.push(f(a))}u(i=c(i),-9),u(i,-8),u(i,1),u(i,10),u(i,9),u(i,8),u(i,-1),u(i,-10),t.splice(a),t[a]=B,a++,Sound.play(B.length<8?"move1":"move2"),function(){for(var a=0;a<2;a++){r=r==Board.BLACK?Board.WHITE:Board.BLACK;for(var t=0;t<64&&!n(t);t++);if(t<64)break}a<2?o=a>0:(r=null,o=!1)}()},this.undo=function(){if(a<=0)return;r=t[--a][0],o=!1,Board.setDisc(t[a][1],Board.EMPTY),Board.setMoveMark(a>0?t[a-1][1]:null);for(var i=r==Board.BLACK?Board.WHITE:Board.BLACK,n=2;n<t[a].length;n++)Board.setDisc(t[a][n],i,30);Sound.play("move1")},this.getDiscNum=function(){for(var r=0,a=0,o=0;o<64;o++)switch(Board.getDisc(o)){case Board.BLACK:r++;break;case Board.WHITE:a++}var t=r-a,i=64-(r+a);t>0?t+=i:t<0&&(t-=i);return{black:r,white:a,empty:i,diff:t}},this.showCanFlip=function(){for(var r=0;r<64;r++)n(r)?B(r):d(r)},this.hideCanFlip=s,this.showMark=B,this.hideMark=d,this.animCantFlip=function(a,o){var t=!1;Tick.interval("flip-"+a,function(){return t?(o?B(a):Board.setMark(a,0),!1):(r==Board.BLACK?Board.setMark(a,50,0,17,17,.6):Board.setMark(a,50,255,238,238,.6),t=!0,!0)},200)},this.toC=c,this.toP=f};